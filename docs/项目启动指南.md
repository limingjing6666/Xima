# Xima 项目启动指南

## 环境要求

| 工具 | 版本 | 说明 |
|------|------|------|
| JDK | 17+ | 后端运行环境 |
| Maven | 3.8+ | 后端构建工具 |
| Node.js | 18+ | 前端运行环境 |
| MySQL | 8.0+ | 主数据库 |
| Redis | 7+ | 缓存（可选） |
| Docker | 20.10+ | 容器化部署 |

## 快速启动

### 方式一：本地开发

**1. 初始化数据库**
```bash
# 执行初始化脚本
mysql -u root -p < sql/local-init.sql
```

**2. 启动后端**
```bash
cd src/backend/xima-app
mvn spring-boot:run
```

**3. 启动前端**
```bash
cd src/frontend/xima-web
npm install
npm run dev
```

**4. 访问应用**
- 前端: http://localhost:3000
- 后端: http://localhost:8080/api
- Swagger: http://localhost:8080/api/swagger-ui.html

### 方式二：Docker 部署

```bash
# 一键启动所有服务
docker compose up -d

# 访问
# 前端: http://localhost
# 后端: http://localhost:8080/api
```

## 项目结构

```
Xima/
├── src/
│   ├── backend/xima-app/          # Spring Boot 后端
│   │   ├── src/main/java/         # Java 源码
│   │   │   └── com/xima/app/
│   │   │       ├── controller/    # REST 控制器
│   │   │       ├── service/       # 业务逻辑
│   │   │       ├── mapper/        # MyBatis Mapper
│   │   │       ├── entity/        # 实体类
│   │   │       ├── dto/           # 数据传输对象
│   │   │       ├── config/        # 配置类
│   │   │       ├── security/      # 安全认证
│   │   │       └── websocket/     # WebSocket
│   │   └── src/main/resources/
│   │       ├── application.yml    # 本地配置
│   │       ├── application-docker.yml  # Docker配置
│   │       └── mapper/            # MyBatis XML
│   │
│   └── frontend/xima-web/         # Vue 3 前端
│       └── src/
│           ├── views/             # 页面组件
│           ├── api/               # API 接口
│           ├── stores/            # Pinia 状态
│           └── router/            # 路由配置
│
├── docker/                        # Docker 配置
│   ├── mysql/init/               # 数据库初始化
│   ├── redis/                    # Redis 配置
│   └── nginx/                    # Nginx 配置
│
├── deploy/                        # 部署脚本
│   ├── install-docker.sh         # Docker 安装
│   ├── deploy.sh                 # 一键部署
│   └── backup.sh                 # 数据备份
│
├── sql/                           # SQL 脚本
│   └── local-init.sql            # 本地初始化
│
└── docs/                          # 项目文档
```

## 配置说明

### 后端配置 (application.yml)

```yaml
# 数据库
spring.datasource.url: jdbc:mysql://localhost:3306/xima
spring.datasource.username: root
spring.datasource.password: 123456

# Redis（可选，不配置则使用内存缓存）
spring.redis.host: localhost
spring.redis.port: 6379

# JWT
jwt.secret: your_secret_key
jwt.expiration: 86400000
```

### 前端配置

开发环境自动代理到后端，无需额外配置。

## 测试账号

| 用户名 | 密码 | 角色 |
|--------|------|------|
| admin | 123456 | 管理员 |
| test | 123456 | 普通用户 |
| user1 | 123456 | 普通用户 |
| user2 | 123456 | 普通用户 |

## 常用命令

```bash
# 运行测试
cd src/backend/xima-app
mvn test

# 打包
mvn clean package -DskipTests

# Docker 构建
docker compose build

# 查看日志
docker compose logs -f backend
```

## 常见问题

### 端口被占用
```bash
# 查看端口占用
netstat -ano | findstr :8080
netstat -ano | findstr :3306

# 杀死进程
taskkill /PID <进程ID> /F
```

### 数据库连接失败
1. 确认 MySQL 服务已启动
2. 检查用户名密码是否正确
3. 确认数据库 `xima` 已创建

### 前端启动失败
```bash
# 清理并重装依赖
rm -rf node_modules
npm install
```